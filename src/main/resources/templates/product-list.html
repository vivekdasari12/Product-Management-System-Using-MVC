<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Product List - MyStore</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background-color: #f8f9fa;
        }

        .navbar {
            margin-bottom: 20px;
        }

        .table {
            background-color: white;
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .table th {
            background-color: #0d6efd;
            color: white;
            text-align: center;
        }

        .table td {
            vertical-align: middle;
            text-align: center;
        }

        .product-image {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
        }

        .btn-sm {
            font-weight: 600;
        }
    </style>
</head>
<body>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm sticky-top">
        <div class="container">
            <a class="navbar-brand fw-bold" th:href="@{/}">MyStore</a>
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" th:href="@{/productform}">Home</a></li>
                    <li class="nav-item"><a class="nav-link" th:href="@{/addProduct}">Add Product</a></li>
                    <li class="nav-item"><a class="nav-link active" th:href="@{/products}">Product List</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Container -->
    <div class="container py-5">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h3 class="fw-bold text-primary">Product List</h3>
            <a th:href="@{/addProduct}" class="btn btn-success btn-sm">+ Add New Product</a>
        </div>
		
		<!-- ✅ Search Form -->
		
		<div class="search-container mb-4">
		    <form th:action="@{/products}" method="get" class="d-flex justify-content-end align-items-center">
		        <div class="input-group search-box shadow-sm">
		            <span class="input-group-text bg-primary text-white">
		                <i class="bi bi-search"></i>
		            </span>
		            <input type="text"
		                   name="keyword"
		                   class="form-control"
		                   placeholder="Search by ID, Name, or Brand..."
		                   th:value="${keyword}">
		            <button type="submit" class="btn btn-primary">Search</button>
		            <a th:href="@{/products}" class="btn btn-outline-secondary">Reset</a>
		        </div>
		    </form>
		</div>


        <!-- ✅ Flash Messages -->
        <div th:if="${successMsg}" class="alert alert-success text-center fw-bold" role="alert">
            <span th:text="${successMsg}"></span>
        </div>
        <div th:if="${errorMsg}" class="alert alert-danger text-center fw-bold" role="alert">
            <span th:text="${errorMsg}"></span>
        </div>

        <!-- ✅ Table: Products -->
        <div th:if="${#lists.isEmpty(getproducts)}" class="alert alert-warning text-center">
            No products found! <a th:href="@{/addProduct}" class="alert-link">Add one now</a>.
        </div>

        <div th:if="${!#lists.isEmpty(getproducts)}">
            <table class="table table-bordered table-hover align-middle">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Image</th>
                        <th>Name</th>
                        <th>Brand</th>
                        <th>Price (₹)</th>
                        <th>Discount (₹)</th>
                        <th>Total (₹)</th>
                        <th>Quantity</th>
                        <th>Owner</th>
                        <th>Created At</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="product : ${getproducts}">
                        <td th:text="${product.id}"></td>
      					<!-- Display Image-->
						<td>
							<img th:if="${product.imageurl != null}"
							     th:src="@{'/' + ${product.imageurl}}"
							     alt="Product Image"
							     class="img-thumbnail"
							     width="80">

						    
						    <span th:if="${product.imageurl == null}" class="text-muted">No Image</span>
						</td>


                        <td th:text="${product.name}"></td>
                        <td th:text="${product.brand}"></td>
                        <td th:text="${product.price}"></td>
                        <td th:text="${product.discountPrice}"></td>
                        <td th:text="${product.totalPrice}"></td>
                        <td th:text="${product.quantity}"></td>
                        <td th:text="${product.owner}"></td>
                        <td th:text="${#temporals.format(product.createdAt, 'dd-MM-yyyy HH:mm')}"></td>

                        <!-- ✅ Actions -->
                        <td>
                            <a th:href="@{'/editProduct/' + ${product.id}}" 
                               class="btn btn-warning btn-sm">Edit</a>
                            <a th:href="@{'/deleteProduct/' + ${product.id}}" 
                               class="btn btn-danger btn-sm" 
                               onclick="return confirm('Are you sure you want to delete this product?');">Delete</a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
